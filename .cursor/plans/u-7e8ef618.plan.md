<!-- 7e8ef618-a1eb-4561-9e12-4775b229558d 254be028-8f41-4d52-abff-f98d1df50728 -->
# Display Dependencies in Experiment Tree Content Tab

## Overview

Add dependency display functionality to the experiment tree UI. Dependencies will be shown at the top of the content tab (before the text content) as a simple clickable list showing node names and dependency types.

## Implementation Steps

### 1. Update Nodes API to Fetch Dependencies

**File:** `app/api/trees/[treeId]/nodes/route.ts`

- Modify the GET endpoint to fetch dependencies from `node_dependencies` table
- Join with `tree_nodes` to get the target node's name (the node being depended upon)
- Include dependencies in the response for each node
- Query dependencies where `from_node_id` matches the node's ID
- Fetch target node names using `to_node_id`

### 2. Update ExperimentNode Interface

**File:** `app/project/[projectId]/trees/[treeId]/page.tsx`

- Add `dependencies` field to `ExperimentNode` interface
- Type: `Array<{ id: string; to_node_id: string; to_node_name: string; dependency_type: string; evidence_text?: string }>`

### 3. Update Content Tab UI

**File:** `app/project/[projectId]/trees/[treeId]/page.tsx`

- In the content tab (around line 2125), add dependencies display before the content text
- Only show if `selectedNode.dependencies && selectedNode.dependencies.length > 0`
- Display as a simple list with:
- Dependency type badge/label (requires, uses_output, follows, validates)
- Target node name (clickable)
- Click handler to navigate to the target node by setting `setSelectedNodeId(dep.to_node_id)`
- Position: After the "Content" header but before the content text area/view

### 4. Add Dependency Type Labels

- Use consistent labels: "Requires", "Uses Output", "Follows", "Validates"
- Style dependency type as a small badge or label
- Style node names as clickable links (use button or link styling)

## Files to Modify

1. `app/api/trees/[treeId]/nodes/route.ts` - Fetch dependencies in GET endpoint
2. `app/project/[projectId]/trees/[treeId]/page.tsx` - Update interface and add UI display

## Notes

- Dependencies are stored in `node_dependencies` table with columns: `from_node_id`, `to_node_id`, `dependency_type`, `evidence_text`
- Only show dependencies section if dependencies exist (hide if empty)
- Navigation to target node should work by setting the selected node ID

### To-dos

- [ ] Update GET /api/trees/[treeId]/nodes to fetch dependencies from node_dependencies table and include target node names
- [ ] Add dependencies field to ExperimentNode interface in tree page component
- [ ] Add dependencies display section at top of content tab with clickable node names